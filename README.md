# Telegram Support Bot

> Telegram-–±–æ—Ç –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å —Å–∏—Å—Ç–µ–º–æ–π —Ç–∏–∫–µ—Ç–æ–≤, invite-code –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ CSAT –æ—Ü–µ–Ω–∫–∞–º–∏.

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| **Invite-code –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** | –ü—Ä–∏–≤—è–∑–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –∫ –ø—Ä–æ–µ–∫—Ç–∞–º —á–µ—Ä–µ–∑ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–æ–¥—ã |
| **–°–∏—Å—Ç–µ–º–∞ —Ç–∏–∫–µ—Ç–æ–≤** | –ö–∞–∂–¥–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ = –æ—Ç–¥–µ–ª—å–Ω—ã–π topic –≤ Support Group |
| **–ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è** | 9 —Ç–∏–ø–æ–≤ –æ–±—Ä–∞—â–µ–Ω–∏–π: –±–∞–≥, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, –¥–æ—Å—Ç—É–ø—ã, –∏ –¥—Ä. |
| **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞–º–∏** | new ‚Üí in_progress ‚Üí closed —á–µ—Ä–µ–∑ inline-–∫–Ω–æ–ø–∫–∏ |
| **CSAT** | –°–±–æ—Ä –æ—Ü–µ–Ω–æ–∫ (üëç/üëé) –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Ç–∏–∫–µ—Ç–∞ |
| **–í–ª–æ–∂–µ–Ω–∏—è** | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –≥–æ–ª–æ—Å–æ–≤—ã—Ö |
| **Triage** | –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ invite-code |

---

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Python** 3.11+
- **Telegram Bot Token** (–æ—Ç @BotFather)
- **Telegram Group** —Å –≤–∫–ª—é—á—ë–Ω–Ω—ã–º–∏ topics

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone <repository-url>
cd CustomerSupport

# 2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
cd backend
python -m venv .venv
source .venv/bin/activate  # –∏–ª–∏ .venv\Scripts\activate –Ω–∞ Windows

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env —Å –≤–∞—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

# 5. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
python -m app.main
```

### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ Telegram

1. –°–æ–∑–¥–∞—Ç—å –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather) –∏ –ø–æ–ª—É—á–∏—Ç—å `BOT_TOKEN`
2. –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É "Support Team" –∏ –≤–∫–ª—é—á–∏—Ç—å Topics (Settings ‚Üí Topics)
3. –î–æ–±–∞–≤–∏—Ç—å –±–æ—Ç–∞ –≤ –≥—Ä—É–ø–ø—É —Å –ø—Ä–∞–≤–∞–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
4. –ü–æ–ª—É—á–∏—Ç—å `SUPPORT_CHAT_ID` (–æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É, –ø–µ—Ä–µ—Å–ª–∞—Ç—å –±–æ—Ç—É @userinfobot)
5. –ü–æ–ª—É—á–∏—Ç—å `user_id` –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –¥–ª—è `OPERATORS`

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
CustomerSupport/
‚îú‚îÄ‚îÄ .cursorrules              # –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è Cursor AI
‚îú‚îÄ‚îÄ .cursor/rules/            # –î–µ—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ backend.mdc
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ .flake8
‚îú‚îÄ‚îÄ README.md
‚îÇ
‚îú‚îÄ‚îÄ backend/                  # Python Telegram Bot
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ bot/              # Telegram bot handlers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers/     # Message & callback handlers
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ keyboards/    # Inline keyboards
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middlewares/  # Bot middlewares
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ states/       # FSM states
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database/         # SQLite models & operations
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py     # SQLAlchemy models
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ operations.py # CRUD operations
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/         # Business logic
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/            # Helpers
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config/           # Configuration
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ settings.py   # Pydantic settings
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ texts.py      # Bot messages templates
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.py           # Entry point
‚îÇ   ‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ unit/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ conftest.py
‚îÇ   ‚îú‚îÄ‚îÄ data/                 # SQLite database (gitignored)
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
‚îÇ   ‚îú‚îÄ‚îÄ .env
‚îÇ   ‚îî‚îÄ‚îÄ .env.example
‚îÇ
‚îú‚îÄ‚îÄ docs/                     # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ product-requirements.md   # –¢–ó –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ project-plan.md           # –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ technical-summary.md      # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ–±–∑–æ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ architecture.md           # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ database-schema.md        # –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ bot-flows.md              # User flows –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ message-templates.md      # –¢–µ–∫—Å—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ agent-prompts.md          # –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ changelogs/               # –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
‚îÇ
‚îî‚îÄ‚îÄ scripts/                  # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
    ‚îî‚îÄ‚îÄ init_data.py          # –ù–∞—á–∞–ª—å–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–î
```

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

| –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------------|------------|
| **Python 3.11+** | –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è |
| **aiogram 3.x** | Telegram Bot framework |
| **SQLAlchemy 2.0** | ORM |
| **SQLite** | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| **Pydantic** | –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è |
| **pytest** | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```env
# === Telegram Bot ===
BOT_TOKEN=your_bot_token_here
SUPPORT_CHAT_ID=-100xxxxxxxxxx
OPERATORS=123456789,987654321

# === Application ===
TIMEZONE=Europe/Madrid
DB_PATH=./data/support.sqlite
LOG_LEVEL=info

# === Working Hours ===
WORK_HOURS_START=10
WORK_HOURS_END=19
WORK_DAYS=1,2,3,4,5
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `backend/app/config/settings.py` ‚Äî Pydantic Settings
- `backend/app/config/texts.py` ‚Äî –¢–µ–∫—Å—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π –±–æ—Ç–∞
- `backend/app/config/categories.py` ‚Äî –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ–±—Ä–∞—â–µ–Ω–∏–π

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
cd backend

# –í—Å–µ —Ç–µ—Å—Ç—ã
pytest -v

# –¢–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
pytest -v -m unit

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=app --cov-report=html

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
flake8 app/
black app/ --check
isort app/ --check
mypy app/
```

---

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –î–æ–∫—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| [docs/product-requirements.md](docs/product-requirements.md) | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ |
| [docs/project-plan.md](docs/project-plan.md) | –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø–æ —Ñ–∞–∑–∞–º |
| [docs/deployment.md](docs/deployment.md) | –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é |
| [docs/technical-summary.md](docs/technical-summary.md) | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ–±–∑–æ—Ä |
| [docs/architecture.md](docs/architecture.md) | –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã |
| [docs/database-schema.md](docs/database-schema.md) | –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLite |
| [docs/bot-flows.md](docs/bot-flows.md) | User flows –±–æ—Ç–∞ |
| [docs/message-templates.md](docs/message-templates.md) | –¢–µ–∫—Å—Ç—ã —Å–æ–æ–±—â–µ–Ω–∏–π |
| [docs/agent-prompts.md](docs/agent-prompts.md) | –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è AI –∞–≥–µ–Ω—Ç–æ–≤ |

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

---

*–°–æ–∑–¥–∞–Ω–æ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Cursor IDE –∏ AI-–∞–≥–µ–Ω—Ç–æ–≤*
